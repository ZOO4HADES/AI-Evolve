<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®½åº¦è®¡ç®—è¯Šæ–­å·¥å…· V2</title>
    <style>
        body {
            padding: 20px;
            background: #0a0e27;
            color: #fff;
            font-family: 'Courier New', monospace;
        }
        h1 {
            color: #00f0ff;
        }
        h2 {
            color: #10b981;
            margin-top: 30px;
        }
        .section {
            background: rgba(255,255,255,0.05);
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 3px solid #00f0ff;
        }
        .result {
            background: rgba(0,0,0,0.3);
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
        }
        .success {
            color: #10b981;
        }
        .warning {
            color: #f59e0b;
        }
        .error {
            color: #ef4444;
        }
        .bar-container {
            width: 100%;
            height: 40px;
            background: rgba(0,0,0,0.5);
            border-radius: 4px;
            margin: 10px 0;
            position: relative;
        }
        .bar {
            height: 100%;
            background: linear-gradient(90deg, #00f0ff, #10b981);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
        }
        .code {
            background: rgba(0,0,0,0.5);
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ğŸ” æŸ±çŠ¶å›¾å®½åº¦è®¡ç®—è¯Šæ–­å·¥å…· V2</h1>

    <div class="section">
        <h2>1ï¸âƒ£ è®¡ç®—å‡½æ•°éªŒè¯</h2>
        <div id="calculation-results"></div>
    </div>

    <div class="section">
        <h2>2ï¸âƒ£ è§†è§‰æµ‹è¯•ï¼ˆä¸åŒELOçš„å®½åº¦ï¼‰</h2>
        <div id="visual-test"></div>
    </div>

    <div class="section">
        <h2>3ï¸âƒ£ æ•°æ®å®Œæ•´æ€§æ£€æŸ¥</h2>
        <div id="data-check"></div>
    </div>

    <div class="section">
        <h2>4ï¸âƒ£ è¯Šæ–­å»ºè®®</h2>
        <div id="recommendations"></div>
    </div>

    <script>
        // ==================== è®¡ç®—å‡½æ•°ï¼ˆä¸chart-v3.jså®Œå…¨ä¸€è‡´ï¼‰ ====================
        function calculateBarWidth(elo) {
            const minElo = 1000;
            const maxElo = 1600;
            const minWidth = 30;  // âœ… é™ä½æœ€å°å®½åº¦ï¼Œå¢å¤§åŠ¨æ€èŒƒå›´
            const maxWidth = 100; // âœ… ä»95æå‡åˆ°100ï¼Œå……åˆ†åˆ©ç”¨ç©ºé—´

            const percentage = (elo - minElo) / (maxElo - minElo);
            const width = minWidth + percentage * (maxWidth - minWidth);

            return {
                width: width,
                percentage: percentage,
                minElo: minElo,
                maxElo: maxElo,
                minWidth: minWidth,
                maxWidth: maxWidth
            };
        }

        // ==================== æµ‹è¯•ç”¨ä¾‹ ====================
        const testCases = [
            { elo: 1000, description: 'ç†è®ºæœ€å°ELO' },
            { elo: 1200, description: 'ä½åˆ†æ¨¡å‹' },
            { elo: 1300, description: 'ä¸­ä½åˆ†æ¨¡å‹' },
            { elo: 1400, description: 'ä¸­é«˜åˆ†æ¨¡å‹' },
            { elo: 1500, description: 'é«˜åˆ†æ¨¡å‹' },
            { elo: 1567, description: 'Topæ¨¡å‹ï¼ˆ2025-12ç¬¬ä¸€ï¼‰' },
            { elo: 1600, description: 'ç†è®ºæœ€å¤§ELO' }
        ];

        // ==================== 1. è®¡ç®—å‡½æ•°éªŒè¯ ====================
        const calcResults = document.getElementById('calculation-results');
        let calcHTML = '<div class="result"><strong>è®¡ç®—å‡½æ•°éªŒè¯ï¼š</strong></div>';

        testCases.forEach(test => {
            const result = calculateBarWidth(test.elo);
            calcHTML += `
                <div class="result">
                    <strong>ELO ${test.elo}</strong> (${test.description})<br>
                    â”œâ”€ ç™¾åˆ†æ¯”: ${(result.percentage * 100).toFixed(2)}%<br>
                    â”œâ”€ è®¡ç®—å®½åº¦: ${result.width.toFixed(2)}%<br>
                    â””â”€ <span class="${result.width >= 96 ? 'success' : result.width >= 80 ? 'warning' : ''}">
                        é¢„æœŸè§†è§‰å®½åº¦: ${result.width >= 96 ? 'æ¥è¿‘100%' : result.width >= 80 ? 'è¾ƒå®½' : 'æ­£å¸¸'}
                       </span>
                </div>
            `;
        });

        calcHTML += `
            <div class="result">
                <strong>å‚æ•°é…ç½®ï¼š</strong><br>
                â”œâ”€ minElo: ${calculateBarWidth(1000).minElo}<br>
                â”œâ”€ maxElo: ${calculateBarWidth(1000).maxElo}<br>
                â”œâ”€ minWidth: ${calculateBarWidth(1000).minWidth}%<br>
                â””â”€ maxWidth: ${calculateBarWidth(1000).maxWidth}%
            </div>
        `;

        calcResults.innerHTML = calcHTML;

        // ==================== 2. è§†è§‰æµ‹è¯• ====================
        const visualTest = document.getElementById('visual-test');
        let visualHTML = '';

        testCases.forEach(test => {
            const result = calculateBarWidth(test.elo);
            visualHTML += `
                <div style="margin: 15px 0;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>ELO ${test.elo} - ${test.description}</span>
                        <span class="success">${result.width.toFixed(2)}%</span>
                    </div>
                    <div class="bar-container">
                        <div class="bar" style="width: ${result.width}%;">
                            ${result.width.toFixed(1)}%
                        </div>
                    </div>
                </div>
            `;
        });

        visualTest.innerHTML = visualHTML;

        // ==================== 3. æ•°æ®å®Œæ•´æ€§æ£€æŸ¥ ====================
        const dataCheck = document.getElementById('data-check');
        let checkHTML = '<div class="result">æ­£åœ¨åŠ è½½æ•°æ®...</div>';

        // å°è¯•åŠ è½½æ•°æ®
        fetch('js/data-bundle-mixed-v2.js')
            .then(response => {
                if (!response.ok) throw new Error('æ— æ³•åŠ è½½æ•°æ®æ–‡ä»¶');
                return response.text();
            })
            .then(code => {
                // æŸ¥æ‰¾2025-12æœˆæ•°æ®
                const match = code.match(/"date": "2025-12"[\s\S]*?"models": \[([\s\S]*?)\]/);
                if (match) {
                    const modelsCode = match[1];
                    const elo1567Match = modelsCode.match(/"elo": 1567/);
                    const elo1545Match = modelsCode.match(/"elo": 1545/);
                    const elo1538Match = modelsCode.match(/"elo": 1538/);

                    checkHTML = `
                        <div class="result ${elo1567Match ? 'success' : 'error'}">
                            âœ… æ•°æ®åŠ è½½æˆåŠŸ
                        </div>
                        <div class="result ${elo1567Match ? 'success' : 'error'}">
                            ${elo1567Match ? 'âœ…' : 'âŒ'} ELO 1567 å­˜åœ¨äºæ•°æ®ä¸­
                        </div>
                        <div class="result ${elo1545Match ? 'success' : 'error'}">
                            ${elo1545Match ? 'âœ…' : 'âŒ'} ELO 1545 å­˜åœ¨äºæ•°æ®ä¸­
                        </div>
                        <div class="result ${elo1538Match ? 'success' : 'error'}">
                            ${elo1538Match ? 'âœ…' : 'âŒ'} ELO 1538 å­˜åœ¨äºæ•°æ®ä¸­
                        </div>
                    `;

                    // è®¡ç®—è¿™äº›ELOåº”è¯¥å¯¹åº”çš„å®½åº¦
                    const elos = [1400, 1428, 1446, 1477, 1538, 1545, 1567];
                    checkHTML += '<div class="result"><strong>2025-12æœˆæ¨¡å‹å®½åº¦é¢„æœŸï¼š</strong><br>';
                    elos.forEach(elo => {
                        const result = calculateBarWidth(elo);
                        checkHTML += `&nbsp;&nbsp;ELO ${elo}: ${result.width.toFixed(2)}% å®½åº¦<br>`;
                    });
                    checkHTML += '</div>';
                } else {
                    checkHTML = '<div class="result error">âŒ æ— æ³•æ‰¾åˆ°2025-12æœˆæ•°æ®</div>';
                }
                dataCheck.innerHTML = checkHTML;
            })
            .catch(error => {
                dataCheck.innerHTML = `<div class="result error">âŒ æ•°æ®åŠ è½½å¤±è´¥: ${error.message}</div>`;
            });

        // ==================== 4. è¯Šæ–­å»ºè®® ====================
        const recommendations = document.getElementById('recommendations');
        recommendations.innerHTML = `
            <div class="result">
                <strong>å¦‚æœè¿™ä¸ªé¡µé¢çš„æŸ±çŠ¶å›¾æ˜¾ç¤ºæ­£å¸¸ï¼š</strong><br>
                1. âœ… è®¡ç®—å‡½æ•°æ˜¯æ­£ç¡®çš„<br>
                2. â“ ä¸»é¡µé¢å¯èƒ½å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š<br>
                &nbsp;&nbsp;&nbsp;&nbsp;a) æµè§ˆå™¨ç¼“å­˜æœªæ¸…é™¤ â†’ æŒ‰ Ctrl+Shift+R ç¡¬åˆ·æ–°<br>
                &nbsp;&nbsp;&nbsp;&nbsp;b) CSSæ ·å¼å†²çª â†’ æ£€æŸ¥æµè§ˆå™¨DevTools<br>
                &nbsp;&nbsp;&nbsp;&nbsp;c) JSæ–‡ä»¶ç‰ˆæœ¬ä¸åŒ¹é… â†’ æ£€æŸ¥Networkæ ‡ç­¾ç¡®è®¤?v=9
            </div>
            <div class="result">
                <strong>å¦‚ä½•éªŒè¯ä¸»é¡µé¢ï¼š</strong><br>
                1. æ‰“å¼€ index-v3.html<br>
                2. æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…·<br>
                3. åˆ‡æ¢åˆ°Consoleï¼ˆæ§åˆ¶å°ï¼‰æ ‡ç­¾<br>
                4. ä½¿ç”¨æ–¹å‘é”®åˆ‡æ¢åˆ°2025å¹´12æœˆ<br>
                5. æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºï¼Œåº”è¯¥çœ‹åˆ°ï¼š<br>
                <div class="code">
[å®½åº¦è®¡ç®—] ELO: 1567, ç™¾åˆ†æ¯”: 94.5%, å®½åº¦: 96.2%
                </div>
                6. å¦‚æœçœ‹åˆ°ä¸Šè¿°è¾“å‡ºï¼Œè¯´æ˜è®¡ç®—æ­£ç¡®<br>
                7. ç„¶ååœ¨æ§åˆ¶å°æ‰§è¡Œä»¥ä¸‹ä»£ç æ£€æŸ¥å®é™…æ¸²æŸ“ï¼š<br>
                <div class="code">
const bars = document.querySelectorAll('.bar');<br>
bars.forEach((bar, i) => {<br>
&nbsp;&nbsp;if (i < 5) console.log('Bar', i+1, 'width:', bar.style.width);<br>
});
                </div>
            </div>
            <div class="result">
                <strong>æ¸…é™¤æµè§ˆå™¨ç¼“å­˜çš„æ–¹æ³•ï¼š</strong><br>
                Windows: Ctrl + Shift + Delete â†’ é€‰æ‹©"ç¼“å­˜çš„å›¾åƒå’Œæ–‡ä»¶" â†’ æ¸…é™¤<br>
                Mac: Cmd + Shift + Delete â†’ é€‰æ‹©"ç¼“å­˜çš„å›¾åƒå’Œæ–‡ä»¶" â†’ æ¸…é™¤<br>
                æˆ–è€…ç›´æ¥ç¡¬åˆ·æ–°: Ctrl + Shift + R (Windows) / Cmd + Shift + R (Mac)
            </div>
        `;

        // ==================== æ§åˆ¶å°è¾“å‡º ====================
        console.log('========================================');
        console.log('æŸ±çŠ¶å›¾å®½åº¦è®¡ç®—è¯Šæ–­');
        console.log('========================================');
        testCases.forEach(test => {
            const result = calculateBarWidth(test.elo);
            console.log(`ELO ${test.elo}: ${result.width.toFixed(2)}% (${(result.percentage * 100).toFixed(2)}%)`);
        });
        console.log('========================================');
    </script>
</body>
</html>
